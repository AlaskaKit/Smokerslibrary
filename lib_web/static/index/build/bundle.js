var app=function(){"use strict";function t(){}function n(t){return t()}function e(){return Object.create(null)}function o(t){t.forEach(n)}function r(t){return"function"==typeof t}function a(t,n){return t!=t?n==n:t!==n||t&&"object"==typeof t||"function"==typeof t}function i(t,n){t.appendChild(n)}function c(t,n,e){t.insertBefore(n,e||null)}function s(t){t.parentNode.removeChild(t)}function u(t){return document.createElement(t)}function l(t){return document.createTextNode(t)}function f(){return l(" ")}function d(t,n,e,o){return t.addEventListener(n,e,o),()=>t.removeEventListener(n,e,o)}function h(t,n,e){null==e?t.removeAttribute(n):t.getAttribute(n)!==e&&t.setAttribute(n,e)}function p(t){return""===t?void 0:+t}function m(t,n){n=""+n,t.data!==n&&(t.data=n)}function g(t,n){t.value=null==n?"":n}let $;function b(t){$=t}function y(){if(!$)throw new Error("Function called outside component initialization");return $}function v(t){y().$$.on_mount.push(t)}function _(){const t=y();return(n,e)=>{const o=t.$$.callbacks[n];if(o){const r=function(t,n){const e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,n),e}(n,e);o.slice().forEach(n=>{n.call(t,r)})}}}const k=[],x=[],w=[],E=[],j=Promise.resolve();let B=!1;function N(t){w.push(t)}let A=!1;const S=new Set;function C(){if(!A){A=!0;do{for(let t=0;t<k.length;t+=1){const n=k[t];b(n),I(n.$$)}for(k.length=0;x.length;)x.pop()();for(let t=0;t<w.length;t+=1){const n=w[t];S.has(n)||(S.add(n),n())}w.length=0}while(k.length);for(;E.length;)E.pop()();B=!1,A=!1,S.clear()}}function I(t){if(null!==t.fragment){t.update(),o(t.before_update);const n=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,n),t.after_update.forEach(N)}}const L=new Set;let O;function T(){O={r:0,c:[],p:O}}function q(){O.r||o(O.c),O=O.p}function z(t,n){t&&t.i&&(L.delete(t),t.i(n))}function D(t,n,e,o){if(t&&t.o){if(L.has(t))return;L.add(t),O.c.push(()=>{L.delete(t),o&&(e&&t.d(1),o())}),t.o(n)}}function F(t){t&&t.c()}function J(t,e,a){const{fragment:i,on_mount:c,on_destroy:s,after_update:u}=t.$$;i&&i.m(e,a),N(()=>{const e=c.map(n).filter(r);s?s.push(...e):o(e),t.$$.on_mount=[]}),u.forEach(N)}function M(t,n){const e=t.$$;null!==e.fragment&&(o(e.on_destroy),e.fragment&&e.fragment.d(n),e.on_destroy=e.fragment=null,e.ctx=[])}function P(t,n){-1===t.$$.dirty[0]&&(k.push(t),B||(B=!0,j.then(C)),t.$$.dirty.fill(0)),t.$$.dirty[n/31|0]|=1<<n%31}function W(n,r,a,i,c,u,l=[-1]){const f=$;b(n);const d=r.props||{},h=n.$$={fragment:null,ctx:null,props:u,update:t,not_equal:c,bound:e(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(f?f.$$.context:[]),callbacks:e(),dirty:l};let p=!1;if(h.ctx=a?a(n,d,(t,e,...o)=>{const r=o.length?o[0]:e;return h.ctx&&c(h.ctx[t],h.ctx[t]=r)&&(h.bound[t]&&h.bound[t](r),p&&P(n,t)),e}):[],h.update(),p=!0,o(h.before_update),h.fragment=!!i&&i(h.ctx),r.target){if(r.hydrate){const t=function(t){return Array.from(t.childNodes)}(r.target);h.fragment&&h.fragment.l(t),t.forEach(s)}else h.fragment&&h.fragment.c();r.intro&&z(n.$$.fragment),J(n,r.target,r.anchor),C()}b(f)}class Y{$destroy(){M(this,1),this.$destroy=t}$on(t,n){const e=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return e.push(n),()=>{const t=e.indexOf(n);-1!==t&&e.splice(t,1)}}$set(){}}function G(n){let e,o,r,a;return{c(){e=u("div"),o=u("h1"),r=l("Smoker's Library. Books in the Store: "),a=l(n[0]),h(e,"class","navbar bg-primary")},m(t,n){c(t,e,n),i(e,o),i(o,r),i(o,a)},p(t,[n]){1&n&&m(a,t[0])},i:t,o:t,d(t){t&&s(e)}}}function H(t,n,e){let o;function r(t,n){const e=setInterval(t,n);var o;o=()=>{clearInterval(e)},y().$$.on_destroy.push(o)}let a=new WebSocket("ws://localhost:8000/");return a.onopen=function(t){a.send("storage_state"),r(async()=>{a.send("storage_state")},1e3)},a.onmessage=function(t){let n=t.data;console.log({book_count:n}),e(0,o=n)},[o]}class K extends Y{constructor(t){super(),W(this,t,H,G,a,{})}}function Q(n){let e,o,r,a,p,g,$,b,y,v,_,k,x,w,E,j,B,N,A,S,C,I,L;return{c(){e=u("div"),o=u("h1"),r=l(n[1]),a=f(),p=u("button"),p.textContent="x",g=f(),$=u("h3"),b=l("id: "),y=l(n[0]),v=f(),_=u("h3"),k=l("year: "),x=l(n[2]),w=f(),E=u("h3"),j=l("author: "),B=l(n[3]),N=f(),A=u("h3"),S=l("ISBN: "),C=l(n[4]),h(p,"class","btn btn-danger btn-sm"),h(o,"class","svelte-1ekm9jl"),h($,"class","svelte-1ekm9jl"),h(_,"class","svelte-1ekm9jl"),h(E,"class","svelte-1ekm9jl"),h(A,"class","svelte-1ekm9jl"),h(e,"class","card")},m(t,s){c(t,e,s),i(e,o),i(o,r),i(o,a),i(o,p),i(e,g),i(e,$),i($,b),i($,y),i(e,v),i(e,_),i(_,k),i(_,x),i(e,w),i(e,E),i(E,j),i(E,B),i(e,N),i(e,A),i(A,S),i(A,C),I||(L=d(p,"click",n[5]),I=!0)},p(t,[n]){2&n&&m(r,t[1]),1&n&&m(y,t[0]),4&n&&m(x,t[2]),8&n&&m(B,t[3]),16&n&&m(C,t[4])},i:t,o:t,d(t){t&&s(e),I=!1,L()}}}function R(t,n,e){const o=_();let{id:r}=n,{name:a}=n,{year:i}=n,{author:c}=n,{isbn:s}=n;return t.$set=t=>{"id"in t&&e(0,r=t.id),"name"in t&&e(1,a=t.name),"year"in t&&e(2,i=t.year),"author"in t&&e(3,c=t.author),"isbn"in t&&e(4,s=t.isbn)},[r,a,i,c,s,()=>o("removebook",r)]}class U extends Y{constructor(t){super(),W(this,t,R,Q,a,{id:0,name:1,year:2,author:3,isbn:4})}}function V(n){let e,r,a,l,m,$,b,y,v,_,k,x;return{c(){e=u("form"),r=u("input"),a=f(),l=u("input"),m=f(),$=u("input"),b=f(),y=u("input"),v=f(),_=u("input"),h(r,"type","text"),h(r,"placeholder","Book Name"),h(l,"type","number"),h(l,"placeholder","Book Year"),h($,"type","number"),h($,"placeholder","Authors_id"),h(y,"type","text"),h(y,"placeholder","ISBN"),h(_,"type","submit"),h(_,"class","btn btn-primary"),_.value="Add Book",h(e,"class","grid-3")},m(t,o){c(t,e,o),i(e,r),g(r,n[0].name),i(e,a),i(e,l),g(l,n[0].year),i(e,m),i(e,$),g($,n[0].authors_id),i(e,b),i(e,y),g(y,n[0].isbn),i(e,v),i(e,_),k||(x=[d(r,"input",n[2]),d(l,"input",n[3]),d($,"input",n[4]),d(y,"input",n[5]),d(e,"submit",n[1])],k=!0)},p(t,[n]){1&n&&r.value!==t[0].name&&g(r,t[0].name),1&n&&p(l.value)!==t[0].year&&g(l,t[0].year),1&n&&p($.value)!==t[0].authors_id&&g($,t[0].authors_id),1&n&&y.value!==t[0].isbn&&g(y,t[0].isbn)},i:t,o:t,d(t){t&&s(e),k=!1,o(x)}}}function X(t,n,e){const o=_();let r={name:"",year:"",authors_id:"",isbn:""};return[r,t=>{t.preventDefault(),o("addbook",r),e(0,r={name:"",year:"",authors_id:"",isbn:""})},function(){r.name=this.value,e(0,r)},function(){r.year=p(this.value),e(0,r)},function(){r.authors_id=p(this.value),e(0,r)},function(){r.isbn=this.value,e(0,r)}]}class Z extends Y{constructor(t){super(),W(this,t,X,V,a,{})}}function tt(t,n,e){const o=t.slice();return o[4]=n[e],o}function nt(t){let n,e,o=t[0],r=[];for(let n=0;n<o.length;n+=1)r[n]=ot(tt(t,o,n));const a=t=>D(r[t],1,1,()=>{r[t]=null});return{c(){for(let t=0;t<r.length;t+=1)r[t].c();n=l("")},m(t,o){for(let n=0;n<r.length;n+=1)r[n].m(t,o);c(t,n,o),e=!0},p(t,e){if(5&e){let i;for(o=t[0],i=0;i<o.length;i+=1){const a=tt(t,o,i);r[i]?(r[i].p(a,e),z(r[i],1)):(r[i]=ot(a),r[i].c(),z(r[i],1),r[i].m(n.parentNode,n))}for(T(),i=o.length;i<r.length;i+=1)a(i);q()}},i(t){if(!e){for(let t=0;t<o.length;t+=1)z(r[t]);e=!0}},o(t){r=r.filter(Boolean);for(let t=0;t<r.length;t+=1)D(r[t]);e=!1},d(t){!function(t,n){for(let e=0;e<t.length;e+=1)t[e]&&t[e].d(n)}(r,t),t&&s(n)}}}function et(n){let e;return{c(){e=u("p"),e.textContent="No Books"},m(t,n){c(t,e,n)},p:t,i:t,o:t,d(t){t&&s(e)}}}function ot(t){let n,e;return n=new U({props:{id:t[4].id,name:t[4].name,year:t[4].year,author:t[4].author.name+"_"+t[4].author.surname,isbn:t[4].isbn}}),n.$on("removebook",(function(){r(t[2](t[4].id))&&t[2](t[4].id).apply(this,arguments)})),{c(){F(n.$$.fragment)},m(t,o){J(n,t,o),e=!0},p(e,o){t=e;const r={};1&o&&(r.id=t[4].id),1&o&&(r.name=t[4].name),1&o&&(r.year=t[4].year),1&o&&(r.author=t[4].author.name+"_"+t[4].author.surname),1&o&&(r.isbn=t[4].isbn),n.$set(r)},i(t){e||(z(n.$$.fragment,t),e=!0)},o(t){D(n.$$.fragment,t),e=!1},d(t){M(n,t)}}}function rt(t){let n,e,o,r,a,l,d,p;n=new K({}),r=new Z({}),r.$on("addbook",t[1]);const m=[et,nt],g=[];function $(t,n){return 0===t[0].length?0:1}return l=$(t),d=g[l]=m[l](t),{c(){F(n.$$.fragment),e=f(),o=u("div"),F(r.$$.fragment),a=f(),d.c(),h(o,"class","container")},m(t,s){J(n,t,s),c(t,e,s),c(t,o,s),J(r,o,null),i(o,a),g[l].m(o,null),p=!0},p(t,[n]){let e=l;l=$(t),l===e?g[l].p(t,n):(T(),D(g[e],1,1,()=>{g[e]=null}),q(),d=g[l],d||(d=g[l]=m[l](t),d.c()),z(d,1),d.m(o,null))},i(t){p||(z(n.$$.fragment,t),z(r.$$.fragment,t),z(d),p=!0)},o(t){D(n.$$.fragment,t),D(r.$$.fragment,t),D(d),p=!1},d(t){M(n,t),t&&s(e),t&&s(o),M(r),g[l].d()}}}function at(t,n,e){let o=[];v(async()=>{let t=await fetch("http://localhost:8000/apibooks/");e(0,o=await t.json()),console.log(o)}),v(async()=>{let t=await fetch("http://localhost:8000/apiauthors/"),n=await t.json();console.log(n)});return[o,t=>{const n=t.detail;fetch("http://localhost:8000/apibooks/",{method:"post",headers:{Accept:"*/*","Content-Type":"application/json"},body:JSON.stringify({name:n.name,year:parseInt(n.year),author_id:parseInt(n.authors_id),isbn:n.isbn})})},function(t){fetch("http://localhost:8000/apibooks/"+t+"/",{method:"delete",headers:{Accept:"*/*"}}),e(0,o=o.filter(n=>n.id!==t))}]}return new class extends Y{constructor(t){super(),W(this,t,at,rt,a,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
